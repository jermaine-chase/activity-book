<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Decoder</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js" integrity="sha384-NaWTHo/8YCBYJ59830LTz/P4aQZK1sS0SneOgAvhsIl3zBu8r9RevNg5lHCHAuQ/" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
</head>
<body>

<textarea id="input" style="width: 50%; height: 25%;"></textarea><br><br><br>
<div id="output"></div>

<style>
    table {
        padding: 0px;
        width:696px;
    }
    td {
        padding: 0px;
        text-align: center;
        font-size: 43.5px;
        width: 45.5px;
    }
    tr {
        padding: 0px;
    }
</style>
<script>

    var columns = 15;
	jQuery('#input').change(function() {
		var aInt = 'A'.charCodeAt(0);
		var zInt = 'Z'.charCodeAt(0);
		var phrase = $('#input').val();
		var nextIndexOfSpace = phrase.indexOf(' ');
	    var newLineIdx = 0;
		var coded = [];
		for (var c = 0; c < phrase.length; c++) {
			var x = phrase.charAt(c);
			var j = x.toUpperCase().charCodeAt(0);
			var k = '__';
			var val = j - aInt + 1;
			if (j < aInt || j > zInt) {
				k = x;
				if (j == 32) {
				    val = '&nbsp;';
				}
				else {
				    val = '';
				}
			}

			coded[coded.length] = [k , val];
		}
        var out='<p><table>';
        var td1 = '<tr>';
        var td2 = '<tr>';
        for (var idx = 0; idx < coded.length; idx++) {
            //space found, find next space
            if (coded[idx][1] == '&nbsp;' || idx == (coded.length - 1)) {
                nextIndexOfSpace = phrase.indexOf(' ', nextIndexOfSpace + 1);

                //if next space is beyond the char max, go to new line
                if (nextIndexOfSpace - newLineIdx > columns || nextIndexOfSpace == -1) {
                    out += createLine(coded, 0, newLineIdx, idx);
                    out += createLine(coded, 1, newLineIdx, idx);
                    newLineIdx = idx + 1;
                }
            }
        }
        out += createLine(coded, 0, newLineIdx, coded.length);
        out += createLine(coded, 1, newLineIdx, coded.length);
        out += '</table></p>';
		jQuery('#output').html(out);

	});

	function createLine(arr, row, start, end) {
	   var tr = '';
	   for (var idx = start; idx < end; idx++) {
            tr += '<td>'+arr[idx][row]+'</td>';
	   }

	   var pad = (columns - (end - start)) / 2;
	   var trPad = '<td colspan="'+pad+'">&nbsp;</td>';
	   tr = '<tr>' + (pad>0?trPad:'') + tr + (pad>0?trPad:'') + '</tr>';
	   return tr;
	}

    function demoFromHTML() {
    var pdf = new jsPDF('p', 'pt', 'letter');
    // source can be HTML-formatted string, or a reference
    // to an actual DOM element from which the text will be scraped.
    source = $('#customers')[0];

    // we support special element handlers. Register them with jQuery-style
    // ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
    // There is no support for any other type of selectors
    // (class, of compound) at this time.
    specialElementHandlers = {
        // element with id of "bypass" - jQuery style selector
        '#bypassme': function (element, renderer) {
            // true = "handled elsewhere, bypass text extraction"
            return true
        }
    };
    margins = {
        top: 80,
        bottom: 60,
        left: 40,
        width: 522
    };
    // all coords and widths are in jsPDF instance's declared units
    // 'inches' in this case
    pdf.fromHTML(
    source, // HTML string or DOM elem ref.
    margins.left, // x coord
    margins.top, { // y coord
        'width': margins.width, // max width of content on PDF
        'elementHandlers': specialElementHandlers
    },

    function (dispose) {
        // dispose: object with X, Y of the last line add to the PDF
        //          this allow the insertion of new lines after html
        pdf.save('Test.pdf');
    }, margins);
}

</script>
</body>
</html>